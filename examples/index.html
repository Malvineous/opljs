<!DOCTYPE html>
<html>
  <head>
    <title>opl.js Example</title>
    <style>
      button { color: black; background-color: #ccc; }
      .mute { background-color: #ffcccc; }
      .play { background-color: #ccffcc; }
    </style>
    <script type="importmap">
      {
        "imports": {
          "@malvineous/opl": "https://esm.sh/@malvineous/opl"
        }
      }
    </script>
  </head>
  <body>
  <p>
      Here is a simpler example:<br/>
      <audio controls loop src="" id="aud"></audio>
  </p>
    <script type="module">
      import OPL from '@malvineous/opl'

      const aud = document.getElementById('aud')

      // download imf file
      const imf = new Uint8Array(await fetch('demo.imf').then(r => r.arrayBuffer()));

      // convert imf bytes to wav
      const opl = await OPL.create()
      const bytes = await opl.wave(imf)

      // set audio src to wav file
      aud.src=URL.createObjectURL(new Blob([bytes], { 'type' : 'audio/wav; codecs=0' }))
    </script>
  </body>
</html>